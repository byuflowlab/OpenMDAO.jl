<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Auto-Sparse Examples · OpenMDAO.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">OpenMDAO.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../simple_paraboloid/">A Simple Example</a></li><li><a class="tocitem" href="../nonlinear_circuit/">A More Complicated Example</a></li><li><a class="tocitem" href="../shape_by_conn/">Variable Shapes at Runtime</a></li><li><a class="tocitem" href="../brachistochrone/">A Simple Dymos Example</a></li><li class="is-active"><a class="tocitem" href>Auto-Sparse Examples</a><ul class="internal"><li><a class="tocitem" href="#The-User-Defined-Function"><span>The User-Defined Function</span></a></li><li><a class="tocitem" href="#SparseADExplicitComp-Paraboloid"><span><code>SparseADExplicitComp</code> Paraboloid</span></a></li><li><a class="tocitem" href="#SparseADExplicitComp-with-Actual-Sparsity"><span><code>SparseADExplicitComp</code> with Actual Sparsity</span></a></li><li><a class="tocitem" href="#The-Brachistochrone-with-SparseADExplicitComp"><span>The Brachistochrone with <code>SparseADExplicitComp</code></span></a></li><li><a class="tocitem" href="#The-Brachistochrone-with-SparseADExplicitComp-and-User-Defined-Sparsity"><span>The Brachistochrone with <code>SparseADExplicitComp</code> and User-Defined Sparsity</span></a></li></ul></li><li><a class="tocitem" href="../matrix_free_ad/">Auto-Matrix-Free Examples</a></li><li><a class="tocitem" href="../reference/">API Reference</a></li><li><a class="tocitem" href="../limitations/">Limitations</a></li><li><a class="tocitem" href="../dev_docs/">Developer Docs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Auto-Sparse Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Auto-Sparse Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/byuflowlab/OpenMDAO.jl/blob/master/docs/src/auto_sparse_ad.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Automatic-Sparse-AD"><a class="docs-heading-anchor" href="#Automatic-Sparse-AD">Automatic Sparse AD</a><a id="Automatic-Sparse-AD-1"></a><a class="docs-heading-anchor-permalink" href="#Automatic-Sparse-AD" title="Permalink"></a></h1><p>OpenMDAOCore.jl can create explicit components that are differentiated automatically by the AD packages supported by <a href="https://github.com/JuliaDiff/DifferentiationInterface.jl">DifferentiationInterface.jl</a>, with the derivative calculation accelerated by sparse matrix coloring algorithms. The sparsity pattern can be specified by the user or generated by one of the detection algorithms supported by DifferentiationInterface.jl and dependent packages. The sparsity pattern of the component will also be communicated to OpenMDAO via the <code>rows</code> and <code>cols</code> arguments to <code>add_input</code> and <code>add_output</code>.</p><h2 id="The-User-Defined-Function"><a class="docs-heading-anchor" href="#The-User-Defined-Function">The User-Defined Function</a><a id="The-User-Defined-Function-1"></a><a class="docs-heading-anchor-permalink" href="#The-User-Defined-Function" title="Permalink"></a></h2><p>The interface for the automatic sparse forward-mode AD functionality is a bit different from the &quot;plain&quot; <code>AbstractExplicitComp</code> and <code>AbstractImplicitComp</code> <code>struct</code>s described in earlier examples (see <a href="../simple_paraboloid/#A-Simple-Example:-Optimizing-a-Paraboloid">A Simple Example: Optimizing a Paraboloid</a> or <a href="../nonlinear_circuit/#A-More-Complicated-Example:-Nonlinear-Circuit">A More Complicated Example: Nonlinear Circuit</a>). Instead of creating subtypes of <code>AbstractExplicitComp</code> that implement <code>OpenMDAOCore.setup</code>, <code>OpenMDAOCore.compute!</code>, etc., we&#39;ll be writing a Julia function that performs our desired computation. This user-defined function will then be passed to a constructor of the <code>SparseADExplicitComp</code> <code>struct</code>, which will implement the necessary <code>OpenMDAOCore</code> methods for us.</p><p>The user-defined function <em>must</em> follow one of two forms: either it can be an &quot;in-place&quot; function that writes its outputs to an output vector, or it can be an &quot;out-of-place&quot; function that returns a single output vector. Both types must also have a <code>params</code> argument that will contain inputs that are needed for the calculation, but won&#39;t be differentiated. So, an example of an in-place function would be </p><pre><code class="nohighlight hljs">function f_in_place!(Y, X, params)
   # calculate stuff with X and params, storing result in Y
   return nothing
end</code></pre><p>where <code>X</code> is the input vector and <code>Y</code> is the output vector. (The function doesn&#39;t have to return nothing, but any returned value will be ignored, so I like to include <code>return nothing</code> to make it clear that the return value doesn&#39;t matter.) An out-of-place function would look like</p><pre><code class="nohighlight hljs">function f_out_of_place(X, params)
   # calculate stuff with X and params, returning Y
   return Y
end</code></pre><p>where again <code>X</code> is the input vector.</p><p>Now, the <code>X</code> and <code>Y</code> arguments of those functions must not be plain Julia <code>Vector</code>s, but <code>ComponentVectors</code> from the <a href="https://github.com/jonniedie/ComponentArrays.jl">ComponentArrays.jl</a> package. What are those? They are objects provided by the <a href="https://github.com/SciML/ComponentArrays.jl">ComponentArrays.jl</a> package that act like <code>Vector</code>s, but allow the user to define names for each part (&quot;component&quot;) of the vector. For example:</p><pre><code class="language-julia hljs">using ComponentArrays: ComponentVector

x1 = ComponentVector(foo=-1.0, bar=-2.0, baz=-3.0)
@show x1 x1[3] x1.foo x1[:foo]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">x1 = (foo = -1.0, bar = -2.0, baz = -3.0)
x1[3] = -3.0
x1.foo = -1.0
x1[:foo] = -1.0</code></pre><p>Notice that we can get, say, the third value of <code>x1</code> the usual way (<code>x1[3]</code>), but also by referring to the <code>foo</code> field value via <code>x1.foo</code> and by indexing the <code>ComponentVector</code> with the symbol <code>:foo</code> (<code>x1[:foo]</code>).</p><p>Each of the components in <code>x1</code> are scalars, but they don&#39;t have to be:</p><pre><code class="language-julia hljs">x2 = ComponentVector(foo=-1.0, bar=1:4, baz=reshape(5:10, 2, 3))
@show x2 x2[:foo] x2[:bar] x2[:baz]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">x2 = (foo = -1.0, bar = [1.0, 2.0, 3.0, 4.0], baz = [5.0 7.0 9.0; 6.0 8.0 10.0])
x2[:foo] = -1.0
x2[:bar] = [1.0, 2.0, 3.0, 4.0]
x2[:baz] = [5.0 7.0 9.0; 6.0 8.0 10.0]</code></pre><p>In <code>x2</code>, the <code>foo</code> component is a scalar, <code>bar</code> refers to a <code>Vector</code> (aka a 1D <code>Array</code>) and <code>baz</code> refers to a <code>Matrix</code> (aka a 2D Array). But <code>x2</code> still &quot;looks like&quot; a <code>Vector</code>:</p><pre><code class="language-julia hljs">@show x2[3]  # will give the third value of `x2`, which happens to be the second value of x2[:bar]
@show ndims(x2)  # Should be 1, since a Vector is 1-dimensional
@show length(x2)  # length(x2) gives the total number of entries in `x2`, aka 1 + 4 + 2*3 = 11
@show size(x2)  # size is a length-1 tuple since a Vector has just one dimension</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">x2[3] = 2.0
ndims(x2) = 1
length(x2) = 11
size(x2) = (11,)</code></pre><p>Now, how will we use <code>ComponentVector</code>s here? We&#39;ll use them to define the names and sizes of all the inputs and outputs to our component. For example, with the paraboloid component in <a href="../simple_paraboloid/#A-Simple-Example:-Optimizing-a-Paraboloid">A Simple Example: Optimizing a Paraboloid</a>, we created one component with two inputs <code>x</code> and <code>y</code> and one output <code>f_xy</code>, all scalars. So for that case, our <code>X_ca</code> would be</p><pre><code class="language-julia hljs">X_ca = ComponentVector(x=1.0, y=1.0)
Y_ca = ComponentVector(f_xy=0.0)
@show X_ca Y_ca</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">X_ca = (x = 1.0, y = 1.0)
Y_ca = (f_xy = 0.0)</code></pre><p>Actually, why don&#39;t we try to implement the <code>Paraboloid</code> component using a <code>SparseADExplicitComp</code>?</p><h2 id="SparseADExplicitComp-Paraboloid"><a class="docs-heading-anchor" href="#SparseADExplicitComp-Paraboloid"><code>SparseADExplicitComp</code> Paraboloid</a><a id="SparseADExplicitComp-Paraboloid-1"></a><a class="docs-heading-anchor-permalink" href="#SparseADExplicitComp-Paraboloid" title="Permalink"></a></h2><p>We&#39;ll start fresh, first with importing the stuff we&#39;ll need:</p><pre><code class="language-julia hljs">using ADTypes: ADTypes
using ComponentArrays: ComponentVector
using OpenMDAOCore: OpenMDAOCore
using OpenMDAO: make_component
using SparseMatrixColorings: SparseMatrixColorings</code></pre><p>Next, we need to define the function that implements our paraboloid equation, which, again, is</p><p class="math-container">\[f(x,y) = (x - 3.0)^2 + xy + (y + 4.0)^2 - 3.0\]</p><p>That would look like this:</p><pre><code class="language-julia hljs">function f_paraboloid!(Y_ca, X_ca, params)
    # Get the inputs:
    x = @view(X_ca[:x])
    y = @view(X_ca[:y])
    # Could also do this:
    # x = X_ca.x
    # y = X_ca.y
    # or even this
    # (; x, y) = X_ca

    # Get the output:
    f_xy = @view(Y_ca[:f_xy])
    # Again, could also do this:
    # f_xy = Y_ca.f_xy
    # or
    # (; f_xy) = Y_ca

    # Do the calculation:
    @. f_xy = (x - 3.0)^2 + x*y + (y + 4.0)^2 - 3.0

    # Return value doesn&#39;t matter.
    return nothing
end</code></pre><p>A couple of things to note there:</p><ul><li>The <code>@view</code> macro is used when extracting the inputs and outputs from the <code>X_ca</code> and <code>Y_ca</code> <code>ComponentVector</code>s. This creates a view into the original <code>ComponentVector</code>, instead of a new array with a copy of the original data, which avoids unnecessary allocations and (for the outputs) allows modifications to the view to be reflected in the <code>Y_ca</code> array. In this example everything is a scalar, so no allocations would have happened anyway. But it doesn&#39;t hurt to use <code>@view</code>: it&#39;s a good habit to get into, <em>and</em> it allows us to use the <code>@.</code> <a href="https://docs.julialang.org/en/v1/manual/arrays/#Broadcasting">broadcasting</a> macro with the scalar <code>f_xy</code> output.</li><li>The <code>params</code> argument is not used in this example, but it is still required, since the <code>SparseADExplicitComp</code> constructor will expect the function to accept it.</li></ul><p>Our next step is to create the <code>ComponentVector</code>s that will be used to hold the inputs and outputs:</p><pre><code class="language-julia hljs">X_ca = ComponentVector(x=1.0, y=1.0)
Y_ca = ComponentVector(f_xy=0.0)
@show X_ca Y_ca</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">X_ca = (x = 1.0, y = 1.0)
Y_ca = (f_xy = 0.0)</code></pre><div class="admonition is-warning"><header class="admonition-header">Use sane values for `X_ca`</header><div class="admonition-body"><p>The values of the entries in <code>X_ca</code> will be perturbed slightly when detecting the sparsity pattern of the component&#39;s Jacobian, so don&#39;t use nonsense values or <code>NaN</code>!</p></div></div><p>Now we&#39;re almost ready to create the <code>SparseADExplicitComp</code>. The last step is to decide what AD library to use. OpenMDAOCore.jl relies on the <a href="https://github.com/SciML/ADTypes.jl">ADTypes.jl</a> and DifferentiationInterface.jl packages for implementing the interface for calling the AD. Theoretically we can use any AD that those packages support. We&#39;ll use <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a> for this example, which is a popular and very robust forward-mode AD.</p><pre><code class="language-julia hljs">using ForwardDiff: ForwardDiff
sparse_atol = 1e-10
sparsity_detector = OpenMDAOCore.PerturbedDenseSparsityDetector(ADTypes.AutoForwardDiff(); atol=sparse_atol, method=:direct)
coloring_algorithm = SparseMatrixColorings.GreedyColoringAlgorithm()
ad_backend = ADTypes.AutoSparse(ADTypes.AutoForwardDiff(); sparsity_detector=sparsity_detector, coloring_algorithm=coloring_algorithm)</code></pre><p>That says that we&#39;ll use <code>ForwardDiff.jl</code> to both detect the Jacobian sparsity and perform the derivative calculation itself, with a tolerance of <code>1e-10</code> for detecting zero entries in the Jacobian. The <code>PerturbedDenseSparsityDetector</code> evaluates the Jacobian multiple times, perturbing the input vector by a small amount, to guard against &quot;unluckily&quot; detecting a zero entry in the Jacobian that just happens to be zero for a particular input.</p><p>Now we are finally ready to create the component:</p><pre><code class="language-julia hljs">comp = OpenMDAOCore.SparseADExplicitComp(ad_backend, f_paraboloid!, Y_ca, X_ca; params=nothing)
parab_comp = make_component(comp)</code></pre><p><code>make_component</code> will convert the <code>SparseADExplicitComp</code> into a OpenMDAO Python component that we can use with OpenMDAO. So now we just need to proceed with the paraboloid example as usual:</p><pre><code class="language-julia hljs">using OpenMDAO: om

model = om.Group()
model.add_subsystem(&quot;parab_comp&quot;, parab_comp)

prob = om.Problem(model)

prob.driver = om.ScipyOptimizeDriver()
prob.driver.options[&quot;optimizer&quot;] = &quot;SLSQP&quot;

prob.model.add_design_var(&quot;parab_comp.x&quot;)
prob.model.add_design_var(&quot;parab_comp.y&quot;)
prob.model.add_objective(&quot;parab_comp.f_xy&quot;)

prob.setup(force_alloc_complex=true)

prob.set_val(&quot;parab_comp.x&quot;, 3.0)
prob.set_val(&quot;parab_comp.y&quot;, -4.0)

prob.run_model()
println(prob[&quot;parab_comp.f_xy&quot;])  # Should print `[-15.]`

prob.set_val(&quot;parab_comp.x&quot;, 5.0)
prob.set_val(&quot;parab_comp.y&quot;, -2.0)

prob.run_model()
println(prob.get_val(&quot;parab_comp.f_xy&quot;))  # Should print `[-5.]`</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-15.0
-5.0</code></pre><p>Looks OK so far. But we should check our derivatives, just to be safe. We can do that with the finite difference method:</p><pre><code class="language-julia hljs">println(prob.check_partials(method=&quot;fd&quot;))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">{&#39;parab_comp&#39;: {(&#39;f_xy&#39;, &#39;x&#39;): {&#39;J_fwd&#39;: array([[2.]]), &#39;J_fd&#39;: array([[2.000001]]), &#39;tol violation&#39;: _ErrorData(forward=-9.99632543852158e-07, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=2.0, reverse=0.0, fd=2.0000010003684565), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(2.0), np.float64(2.0000010003684565)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=1.0003684565162985e-06, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=5.001839780740122e-07, reverse=None, fwd_rev=None)}, (&#39;f_xy&#39;, &#39;y&#39;): {&#39;J_fwd&#39;: array([[9.]]), &#39;J_fd&#39;: array([[9.000001]]), &#39;tol violation&#39;: _ErrorData(forward=-7.999542276593274e-06, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=9.0, reverse=0.0, fd=9.000001000458724), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(9.0), np.float64(9.000001000458724)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=1.0004587238654494e-06, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=1.1116206807248763e-07, reverse=None, fwd_rev=None)}}}</code></pre><p>or the complex-step method:</p><pre><code class="language-julia hljs">println(prob.check_partials(method=&quot;cs&quot;))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">{&#39;parab_comp&#39;: {(&#39;f_xy&#39;, &#39;x&#39;): {&#39;J_fwd&#39;: array([[2.]]), &#39;J_fd&#39;: array([[2.]]), &#39;tol violation&#39;: _ErrorData(forward=-2e-06, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=2.0, reverse=0.0, fd=2.0), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(2.0), np.float64(2.0)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None)}, (&#39;f_xy&#39;, &#39;y&#39;): {&#39;J_fwd&#39;: array([[9.]]), &#39;J_fd&#39;: array([[9.]]), &#39;tol violation&#39;: _ErrorData(forward=-9e-06, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=9.0, reverse=0.0, fd=9.0), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(9.0), np.float64(9.0)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None)}}}</code></pre><p>Derivatives look great, so let&#39;s go ahead and perform the optimization:</p><pre><code class="language-julia hljs">prob.run_driver()
println(&quot;f_xy = $(prob.get_val(&quot;parab_comp.f_xy&quot;))&quot;)  # Should print `[-27.33333333]`
println(&quot;x = $(prob.get_val(&quot;parab_comp.x&quot;))&quot;)  # Should print `[6.66666633]`
println(&quot;y = $(prob.get_val(&quot;parab_comp.y&quot;))&quot;)  # Should print `[-7.33333367]`</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-----------------------------------------
Component: JuliaExplicitComp &#39;parab_comp&#39;
-----------------------------------------

  parab_comp: &#39;f_xy&#39; wrt &#39;x&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : (-9.996325e-07)
      abs error: 1.000368e-06
      rel error: 5.001840e-07
      fwd value: 2.000000e+00
      fd value: 2.000001e+00 (fd:forward)

    Raw Forward Derivative (Jfwd)
    [[2.]]

    Raw FD Derivative (Jfd)
    [[2.000001]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  parab_comp: &#39;f_xy&#39; wrt &#39;y&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : (-7.999542e-06)
      abs error: 1.000459e-06
      rel error: 1.111621e-07
      fwd value: 9.000000e+00
      fd value: 9.000001e+00 (fd:forward)

    Raw Forward Derivative (Jfwd)
    [[9.]]

    Raw FD Derivative (Jfd)
    [[9.000001]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

-----------------------------------------
Component: JuliaExplicitComp &#39;parab_comp&#39;
-----------------------------------------

  parab_comp: &#39;f_xy&#39; wrt &#39;x&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : (-2.000000e-06)
      abs error: 0.000000e+00
      rel error: 0.000000e+00
      fwd value: 2.000000e+00
      fd value: 2.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[2.]]

    Raw CS Derivative (Jfd)
    [[2.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  parab_comp: &#39;f_xy&#39; wrt &#39;y&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : (-9.000000e-06)
      abs error: 0.000000e+00
      rel error: 0.000000e+00
      fwd value: 9.000000e+00
      fd value: 9.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[9.]]

    Raw CS Derivative (Jfd)
    [[9.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

f_xy = -27.333333333333336
x = 6.666666666666667
y = -7.333333333333333</code></pre><p>Victory!</p><h2 id="SparseADExplicitComp-with-Actual-Sparsity"><a class="docs-heading-anchor" href="#SparseADExplicitComp-with-Actual-Sparsity"><code>SparseADExplicitComp</code> with Actual Sparsity</a><a id="SparseADExplicitComp-with-Actual-Sparsity-1"></a><a class="docs-heading-anchor-permalink" href="#SparseADExplicitComp-with-Actual-Sparsity" title="Permalink"></a></h2><p>The Paraboloid example does a nice job of showing how to use <code>SparseADExplicitComp</code>, but careful readers will realize that it&#39;s not actually sparse! So let&#39;s try an example with some sparse components: the <a href="https://openmdao.org/newdocs/versions/latest/examples/simul_deriv_example.html">Simple Optimization using Simultaneous Derivatives</a> example from the OpenMDAO docs. That example makes heavy use of <code>ExecComps</code> with <code>has_diag_partials</code>, but we&#39;ll use <code>SparseADExplicitComp</code> to implement each component, and allow it to find the sparsity pattern for us.</p><p>Let&#39;s start with a fresh Julia script and load what we&#39;ll need:</p><pre><code class="language-julia hljs">using ADTypes: ADTypes
using ComponentArrays: ComponentVector
using OpenMDAOCore: OpenMDAOCore
using OpenMDAO: make_component, om
using SparseMatrixColorings: SparseMatrixColorings

# Use the same value of `SIZE` that the official version uses:
SIZE = 10

# Use the same AD as the previous example: ForwardDiff.jl, with `PerturbedDenseSparsityDetector`.
sparse_atol = 1e-10
sparsity_detector = OpenMDAOCore.PerturbedDenseSparsityDetector(ADTypes.AutoForwardDiff(); atol=sparse_atol, method=:direct)
coloring_algorithm = SparseMatrixColorings.GreedyColoringAlgorithm()
ad_backend = ADTypes.AutoSparse(ADTypes.AutoForwardDiff(); sparsity_detector=sparsity_detector, coloring_algorithm=coloring_algorithm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ADTypes.AutoSparse(dense_ad=ADTypes.AutoForwardDiff(), sparsity_detector=OpenMDAOCore.PerturbedDenseSparsityDetector(ADTypes.AutoForwardDiff(); atol=1.0e-10, method=:directnevals=3, rel_x_perturb=0.001abs_x_perturb=0.0001), coloring_algorithm=SparseMatrixColorings.GreedyColoringAlgorithm{:direct, SparseMatrixColorings.NaturalOrder}(SparseMatrixColorings.NaturalOrder(), false))</code></pre><p>Now we&#39;ll need to create some functions that will implement the various calculations we need. Here are the functions for <code>arctan_yox</code>, <code>circle</code>, and <code>r_con</code>, respectively:</p><pre><code class="language-julia hljs">function f_arctan_yox!(Y, X, params)
    # Get views of inputs.
    x = @view(X[:x])
    y = @view(X[:y])

    # Get views of outputs.
    g = @view(Y[:g])

    # Perform the calculation.
    @. g = atan(y/x)

    return nothing
end
Y_ca = ComponentVector(g=ones(SIZE))
X_ca = ComponentVector(x=ones(SIZE), y=ones(SIZE))
comp = OpenMDAOCore.SparseADExplicitComp(ad_backend, f_arctan_yox!, Y_ca, X_ca)
arctan_yox_comp = make_component(comp)

function f_circle!(Y, X, params)
    # Get views of inputs.
    r = X.r

    # Get views of outputs.
    # area = Y.area
    area = @view(Y[:area])

    # Perform the calculation.
    @. area = pi*r^2

    return nothing
end
Y_ca = ComponentVector(area=1.0)
X_ca = ComponentVector(r=1.0)
comp = OpenMDAOCore.SparseADExplicitComp(ad_backend, f_circle!, Y_ca, X_ca)
circle_comp = make_component(comp)

function f_r_con!(Y, X, params)
    # Get views of inputs.
    (; x, y, r) = X

    # Get views of outputs.
    g = Y.g

    # Perform the calculation.
    @. g = x^2 + y^2 - r

    return nothing
end
Y_ca = ComponentVector(g=ones(SIZE))
X_ca = ComponentVector(x=ones(SIZE), y=ones(SIZE), r=1.0)
comp = OpenMDAOCore.SparseADExplicitComp(ad_backend, f_r_con!, Y_ca, X_ca)
r_con_comp = make_component(comp)</code></pre><p>We can check that <code>SparseADExplicitComp</code> has detected the diagonal partials by getting the rows and columns <code>Dict</code> that it constructs. For that last component:</p><pre><code class="language-julia hljs">rcdict = OpenMDAOCore.get_rows_cols_dict(comp)
@show rcdict[:g, :x] rcdict[:g, :y] rcdict[:g, :r]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">rcdict[:g, :x] = ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
rcdict[:g, :y] = ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
rcdict[:g, :r] = ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1])</code></pre><p>The <code>rcdict</code> maps the partials to a tuple of two vectors containing the non-zero rows and non-zero columns of the partial. For example, that output above shows that the derivative of </p><ul><li><code>g[1]</code> with respect to <code>x[1]</code></li><li><code>g[2]</code> with respect to <code>x[2]</code></li><li><code>g[3]</code> with respect to <code>x[3]</code></li></ul><p>etc are all non-zero, and similar for the derivatives of <code>g</code> with respect to <code>y</code>. All entries of <code>g</code> depend on the single value of <code>r</code>, and so <code>rcdict[:g, :r]</code> shows that all indices of <code>g</code> (1 through 10) depend on the single <code>1</code> index of <code>r</code>.</p><p>Next, let&#39;s think about the calculation for the <code>theta_con</code> component, which in the Python example looks like this:</p><pre><code class="language-python hljs">thetas = np.linspace(0, np.pi/4, SIZE)
p.model.add_subsystem(&#39;theta_con&#39;, om.ExecComp(&#39;g = x - theta&#39;, has_diag_partials=True,
                                               g=np.ones(SIZE), x=np.ones(SIZE),
                                               theta=thetas))</code></pre><p>The <code>theta</code> array is hard-coded to go from <code>0</code> to <code>pi/4</code>, but what if we wanted to be able to change that? We could use the <code>params</code> argument to the user-defined function to set the starting and ending value for <code>theta</code>, like so:</p><pre><code class="language-julia hljs">function f_theta_con!(Y, X, params)
    # Get views of inputs.
    x = @view(X[:x])

    # Get views of outputs.
    g = @view(Y[:g])

    # Create the theta parameter.
    theta_min = params.theta_min
    theta_max = params.theta_max
    theta = range(theta_min, theta_max; length=length(x))

    # Perform the calculation.
    @. g = x - theta

    return nothing
end

Y_ca = ComponentVector(g=ones(SIZE))
X_ca = ComponentVector(x=ones(SIZE))
params_theta_con = (theta_min=0.0, theta_max=pi/4)
comp = OpenMDAOCore.SparseADExplicitComp(ad_backend, f_theta_con!, Y_ca, X_ca; params=params_theta_con)
theta_con_comp = make_component(comp)</code></pre><p>Notice that we decided to use a <code>NamedTuple</code> for the <code>params</code> argument. It could be anything, as long as it&#39;s consistent with the definition of <code>f_theta_con!</code>. For example, we could have passed a <code>Vector</code> <code>[0.0, pi/4]</code> to <code>SparseADExplicitComp</code>, then done something like</p><pre><code class="language-julia hljs">theta_min = params[1]
theta_max = params[2]</code></pre><p>in the definition of <code>f_theta_con!</code>. But then we would have had to remember that <code>theta_min</code> is the first entry in <code>params</code>, <code>theta_max</code> the second. Much easier to use a <code>NamedTuple</code>.</p><p>Finally, let&#39;s create the functions for the <code>delta_theta_con</code> and <code>l_conx</code> components:</p><pre><code class="language-julia hljs">function f_delta_theta_con!(Y, X, params)
    # Get views of inputs.
    # even = @view(X[:even])
    # odd = @view(X[:odd])
    (; even, odd) = X

    # Get views of outputs.
    # g = @view(Y[:g])
    (; g) = Y

    # Perform the calculation.
    @. g = even - odd

    return nothing
end
Y_ca = ComponentVector(g=ones(SIZE÷2))
X_ca = ComponentVector(even=ones(SIZE÷2), odd=ones(SIZE÷2))
comp = OpenMDAOCore.SparseADExplicitComp(ad_backend, f_delta_theta_con!, Y_ca, X_ca)
delta_theta_con_comp = make_component(comp)

function f_l_conx!(Y, X, params)
    # Get views of inputs.
    x = @view(X[:x])

    # Get views of outputs.
    g = @view(Y[:g])

    # Perform the calculation.
    @. g = x - 1

    return nothing
end
Y_ca = ComponentVector(g=ones(SIZE))
X_ca = ComponentVector(x=ones(SIZE))
comp = OpenMDAOCore.SparseADExplicitComp(ad_backend, f_l_conx!, Y_ca, X_ca)
l_conx_comp = make_component(comp)</code></pre><p>Excellent. Now we&#39;re finally ready to start creating the OpenMDAO <code>Problem</code>. The rest of the example will closely follow the <a href="https://openmdao.org/newdocs/versions/latest/examples/simul_deriv_example.html">official version</a>.</p><pre><code class="language-julia hljs">p = om.Problem()

p.model.add_subsystem(&quot;arctan_yox&quot;, arctan_yox_comp, promotes_inputs=[&quot;x&quot;, &quot;y&quot;])
p.model.add_subsystem(&quot;circle&quot;, circle_comp, promotes_inputs=[&quot;r&quot;])
p.model.add_subsystem(&quot;r_con&quot;, r_con_comp, promotes_inputs=[&quot;r&quot;, &quot;x&quot;, &quot;y&quot;])
p.model.add_subsystem(&quot;theta_con&quot;, theta_con_comp)
p.model.add_subsystem(&quot;delta_theta_con&quot;, delta_theta_con_comp)
p.model.add_subsystem(&quot;l_conx&quot;, l_conx_comp, promotes_inputs=[&quot;x&quot;])

# OpenMDAO uses 0-based indices, so need to go from 0 to SIZE-1.
IND = 0:SIZE-1
# Julia arrays are 1-based, so 1 will give us the first index, 2 the second, etc..
# Could also use the popular OffsetArrays.jl package to create a 0-based array.
ODD_IND = IND[2:2:end]  # all odd indicies
EVEN_IND = IND[1:2:end-1]  # all even indices

p.model.connect(&quot;arctan_yox.g&quot;, &quot;theta_con.x&quot;)
p.model.connect(&quot;arctan_yox.g&quot;, &quot;delta_theta_con.even&quot;, src_indices=EVEN_IND)
p.model.connect(&quot;arctan_yox.g&quot;, &quot;delta_theta_con.odd&quot;, src_indices=ODD_IND)

p.driver = om.ScipyOptimizeDriver()
p.driver.options[&quot;optimizer&quot;] = &quot;SLSQP&quot;
p.driver.options[&quot;disp&quot;] = false

# set up dynamic total coloring here
p.driver.declare_coloring()

p.model.add_design_var(&quot;x&quot;)
p.model.add_design_var(&quot;y&quot;)
p.model.add_design_var(&quot;r&quot;, lower=.5, upper=10)

# nonlinear constraints
p.model.add_constraint(&quot;r_con.g&quot;, equals=0)

p.model.add_constraint(&quot;theta_con.g&quot;, lower=-1e-5, upper=1e-5, indices=EVEN_IND)
p.model.add_constraint(&quot;delta_theta_con.g&quot;, lower=-1e-5, upper=1e-5)

# this constrains x[0] to be 1 (see definition of l_conx)
p.model.add_constraint(&quot;l_conx.g&quot;, equals=0, linear=false, indices=[0,])

# linear constraint
p.model.add_constraint(&quot;y&quot;, equals=0, indices=[0,], linear=true)

p.model.add_objective(&quot;circle.area&quot;, ref=-1)

p.setup(mode=&quot;fwd&quot;, force_alloc_complex=true)

# the following were randomly generated using np.random.random(10)*2-1 to randomly
# disperse them within a unit circle centered at the origin.
p.set_val(&quot;x&quot;, [ 0.55994437, -0.95923447,  0.21798656, -0.02158783,  0.62183717,
                 0.04007379,  0.46044942, -0.10129622,  0.27720413, -0.37107886])
p.set_val(&quot;y&quot;, [ 0.52577864,  0.30894559,  0.8420792 ,  0.35039912, -0.67290778,
                -0.86236787, -0.97500023,  0.47739414,  0.51174103,  0.10052582])
p.set_val(&quot;r&quot;, .7)</code></pre><p>Let&#39;s check our derivatives:</p><pre><code class="language-julia hljs">println(p.check_partials(method=&quot;cs&quot;))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Optimization terminated successfully    (Exit mode 0)
            Current function value: -27.333333333333336
            Iterations: 4
            Function evaluations: 5
            Gradient evaluations: 4
Optimization Complete
-----------------------------------
-----------------------------------------
Component: JuliaExplicitComp &#39;arctan_yox&#39;
-----------------------------------------

  arctan_yox: &#39;g&#39; wrt &#39;x&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[-0.89117912  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.         -0.30420661  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.         -1.11295523  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.         -2.8430969   0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.80157084  0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          1.15709928  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.83860952  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -2.00445891  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.         -1.51080391  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.6801248 ]]

    Raw CS Derivative (Jfd)
    [[-0.89117912  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.         -0.30420661  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.         -1.11295523  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.         -2.8430969   0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.80157084  0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          1.15709928  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.83860952  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -2.00445891  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.         -1.51080391  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.6801248 ]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  arctan_yox: &#39;g&#39; wrt &#39;y&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[ 0.94908902  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.         -0.94452059  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.28810744  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.         -0.17516109  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.7407353   0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.05376981  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.39603813  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -0.42531756  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.81838481  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -2.51059814]]

    Raw CS Derivative (Jfd)
    [[ 0.94908902  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.         -0.94452059  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.28810744  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.         -0.17516109  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.7407353   0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.05376981  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.39603813  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -0.42531756  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.81838481  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -2.51059814]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

-------------------------------------
Component: JuliaExplicitComp &#39;circle&#39;
-------------------------------------

  circle: &#39;area&#39; wrt &#39;r&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : (-4.398230e-06)
      abs error: 8.881784e-16
      rel error: 2.019400e-16
      fwd value: 4.398230e+00
      fd value: 4.398230e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[4.39822972]]

    Raw CS Derivative (Jfd)
    [[4.39822972]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

------------------------------------
Component: JuliaExplicitComp &#39;r_con&#39;
------------------------------------

  r_con: &#39;g&#39; wrt &#39;r&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : (-1.000000e-06)
      abs error: 0.000000e+00
      rel error: 0.000000e+00
      fwd value: -1.000000e+00
      fd value: -1.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[-1.]
     [-1.]
     [-1.]
     [-1.]
     [-1.]
     [-1.]
     [-1.]
     [-1.]
     [-1.]
     [-1.]]

    Raw CS Derivative (Jfd)
    [[-1.]
     [-1.]
     [-1.]
     [-1.]
     [-1.]
     [-1.]
     [-1.]
     [-1.]
     [-1.]
     [-1.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  r_con: &#39;g&#39; wrt &#39;x&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[ 1.11988874  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.         -1.91846894  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.43597312  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.         -0.04317566  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          1.24367434  0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.08014758  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.92089884  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -0.20259244  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.55440826  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.74215772]]

    Raw CS Derivative (Jfd)
    [[ 1.11988874  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.         -1.91846894  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.43597312  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.         -0.04317566  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          1.24367434  0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.08014758  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.92089884  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -0.20259244  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.55440826  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.74215772]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  r_con: &#39;g&#39; wrt &#39;y&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[ 1.05155728  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.61789118  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          1.6841584   0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.70079824  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.         -1.34581556  0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.         -1.72473574  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.         -1.95000046  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.95478828  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          1.02348206  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.20105164]]

    Raw CS Derivative (Jfd)
    [[ 1.05155728  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.61789118  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          1.6841584   0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.70079824  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.         -1.34581556  0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.         -1.72473574  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.         -1.95000046  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.95478828  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          1.02348206  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.20105164]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
{&#39;arctan_yox&#39;: {(&#39;g&#39;, &#39;x&#39;): {&#39;J_fwd&#39;: array([[-0.89117912,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        , -0.30420661,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        , -1.11295523,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        , -2.8430969 ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.80157084,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         1.15709928,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.83860952,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        , -2.00445891,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        , -1.51080391,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        , -0.6801248 ]]), &#39;J_fd&#39;: array([[-0.89117912,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        , -0.30420661,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        , -1.11295523,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        , -2.8430969 ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.80157084,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         1.15709928,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.83860952,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        , -2.00445891,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        , -1.51080391,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        , -0.6801248 ]]), &#39;tol violation&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=2.843096900810654, reverse=0.0, fd=2.8430969008106537), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(0.0), np.float64(0.0)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=inf, reverse=None, fwd_rev=None)}, (&#39;g&#39;, &#39;y&#39;): {&#39;J_fwd&#39;: array([[ 0.94908902,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        , -0.94452059,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.28810744,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        , -0.17516109,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.7407353 ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.05376981,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.39603813,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        , -0.42531756,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.81838481,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        , -2.51059814]]), &#39;J_fd&#39;: array([[ 0.94908902,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        , -0.94452059,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.28810744,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        , -0.17516109,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.7407353 ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.05376981,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.39603813,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        , -0.42531756,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.81838481,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        , -2.51059814]]), &#39;tol violation&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=2.5105981418168946, reverse=0.0, fd=2.510598141816894), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(0.0), np.float64(0.0)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=inf, reverse=None, fwd_rev=None)}}, &#39;circle&#39;: {(&#39;area&#39;, &#39;r&#39;): {&#39;J_fwd&#39;: array([[4.39822972]]), &#39;J_fd&#39;: array([[4.39822972]]), &#39;tol violation&#39;: _ErrorData(forward=-4.398229714137531e-06, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=4.39822971502571, reverse=0.0, fd=4.3982297150257095), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(4.39822971502571), np.float64(4.3982297150257095)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=8.881784197001252e-16, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=2.0193997977546143e-16, reverse=None, fwd_rev=None)}}, &#39;r_con&#39;: {(&#39;g&#39;, &#39;x&#39;): {&#39;J_fwd&#39;: array([[ 1.11988874,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        , -1.91846894,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.43597312,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        , -0.04317566,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  1.24367434,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.08014758,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.92089884,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        , -0.20259244,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.55440826,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        , -0.74215772]]), &#39;J_fd&#39;: array([[ 1.11988874,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        , -1.91846894,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.43597312,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        , -0.04317566,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  1.24367434,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.08014758,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.92089884,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        , -0.20259244,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.55440826,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        , -0.74215772]]), &#39;tol violation&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=1.91846894, reverse=0.0, fd=1.91846894), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(0.0), np.float64(0.0)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=inf, reverse=None, fwd_rev=None)}, (&#39;g&#39;, &#39;y&#39;): {&#39;J_fwd&#39;: array([[ 1.05155728,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.61789118,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  1.6841584 ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.70079824,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        , -1.34581556,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        -1.72473574,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        , -1.95000046,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.95478828,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  1.02348206,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.20105164]]), &#39;J_fd&#39;: array([[ 1.05155728,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.61789118,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  1.6841584 ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.70079824,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        , -1.34581556,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        -1.72473574,  0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        , -1.95000046,  0.        ,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.95478828,  0.        ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  1.02348206,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ,  0.20105164]]), &#39;tol violation&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=1.95000046, reverse=0.0, fd=1.9500004599999998), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(0.0), np.float64(0.0)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=inf, reverse=None, fwd_rev=None)}, (&#39;g&#39;, &#39;r&#39;): {&#39;J_fwd&#39;: array([[-1.],
       [-1.],
       [-1.],
       [-1.],
       [-1.],
       [-1.],
       [-1.],
       [-1.],
       [-1.],
       [-1.]]), &#39;J_fd&#39;: array([[-1.],
       [-1.],
       [-1.],
       [-1.],
       [-1.],
       [-1.],
       [-1.],
       [-1.],
       [-1.],
       [-1.]]), &#39;tol violation&#39;: _ErrorData(forward=-1e-06, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=1.0, reverse=0.0, fd=1.0), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(-1.0), np.float64(-1.0)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None)}}, &#39;theta_con&#39;: {(&#39;g&#39;, &#39;x&#39;): {&#39;J_fwd&#39;: array([[1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.]]), &#39;J_fd&#39;: array([[1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.]]), &#39;tol violation&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=1.0, reverse=0.0, fd=1.0), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(0.0), np.float64(0.0)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=inf, reverse=None, fwd_rev=None)}}, &#39;delta_theta_con&#39;: {(&#39;g&#39;, &#39;even&#39;): {&#39;J_fwd&#39;: array([[1., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0.],
       [0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 1.]]), &#39;J_fd&#39;: array([[1., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 0.],
       [0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 1.]]), &#39;tol violation&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=1.0, reverse=0.0, fd=1.0), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(0.0), np.float64(0.0)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=inf, reverse=None, fwd_rev=None)}, (&#39;g&#39;, &#39;odd&#39;): {&#39;J_fwd&#39;: array([[-1.,  0.,  0.,  0.,  0.],
       [ 0., -1.,  0.,  0.,  0.],
       [ 0.,  0., -1.,  0.,  0.],
       [ 0.,  0.,  0., -1.,  0.],
       [ 0.,  0.,  0.,  0., -1.]]), &#39;J_fd&#39;: array([[-1.,  0.,  0.,  0.,  0.],
       [ 0., -1.,  0.,  0.,  0.],
       [ 0.,  0., -1.,  0.,  0.],
       [ 0.,  0.,  0., -1.,  0.],
       [ 0.,  0.,  0.,  0., -1.]]), &#39;tol violation&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=1.0, reverse=0.0, fd=1.0), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(0.0), np.float64(0.0)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=inf, reverse=None, fwd_rev=None)}}, &#39;l_conx&#39;: {(&#39;g&#39;, &#39;x&#39;): {&#39;J_fwd&#39;: array([[1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.]]), &#39;J_fd&#39;: array([[1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.]]), &#39;tol violation&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;magnitude&#39;: _MagnitudeData(forward=1.0, reverse=0.0, fd=1.0), &#39;vals_at_max_error&#39;: _ErrorData(forward=(np.float64(0.0), np.float64(0.0)), reverse=None, fwd_rev=None), &#39;abs error&#39;: _ErrorData(forward=0.0, reverse=None, fwd_rev=None), &#39;rel error&#39;: _ErrorData(forward=inf, reverse=None, fwd_rev=None)}}}</code></pre><p>Essentially zero error in the derivatives, so that&#39;s great.</p><p>Finally, let&#39;s do the optimization:</p><pre><code class="language-julia hljs">p.run_driver()
println(&quot;circle.area = $(p[&quot;circle.area&quot;]) (should be about equal to π ≈ $(float(pi)))&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
----------------------------------------
Component: JuliaExplicitComp &#39;theta_con&#39;
----------------------------------------

  theta_con: &#39;g&#39; wrt &#39;x&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]]

    Raw CS Derivative (Jfd)
    [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

----------------------------------------------
Component: JuliaExplicitComp &#39;delta_theta_con&#39;
----------------------------------------------

  delta_theta_con: &#39;g&#39; wrt &#39;even&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[1. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0.]
     [0. 0. 1. 0. 0.]
     [0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 1.]]

    Raw CS Derivative (Jfd)
    [[1. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0.]
     [0. 0. 1. 0. 0.]
     [0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 1.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  delta_theta_con: &#39;g&#39; wrt &#39;odd&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[-1.  0.  0.  0.  0.]
     [ 0. -1.  0.  0.  0.]
     [ 0.  0. -1.  0.  0.]
     [ 0.  0.  0. -1.  0.]
     [ 0.  0.  0.  0. -1.]]

    Raw CS Derivative (Jfd)
    [[-1.  0.  0.  0.  0.]
     [ 0. -1.  0.  0.  0.]
     [ 0.  0. -1.  0.  0.]
     [ 0.  0.  0. -1.  0.]
     [ 0.  0.  0.  0. -1.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

-------------------------------------
Component: JuliaExplicitComp &#39;l_conx&#39;
-------------------------------------

  l_conx: &#39;g&#39; wrt &#39;x&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]]

    Raw CS Derivative (Jfd)
    [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -


Jacobian shape: (22, 21)  (13.42% nonzero)
FWD solves: 5   REV solves: 0
Total colors vs. total size: 5 vs 21  (76.19% improvement)

Sparsity computed using tolerance: 1e-25.
Dense total jacobian for Problem &#39;problem2&#39; was computed 3 times.
Time to compute sparsity:   0.0186 sec
Time to compute coloring:   0.0022 sec
Coloring created on: 2025-05-09 17:08:08
circle.area = 3.141592653589793 (should be about equal to π ≈ 3.141592653589793)</code></pre><p>We got the right answer! Yay!</p><h2 id="The-Brachistochrone-with-SparseADExplicitComp"><a class="docs-heading-anchor" href="#The-Brachistochrone-with-SparseADExplicitComp">The Brachistochrone with <code>SparseADExplicitComp</code></a><a id="The-Brachistochrone-with-SparseADExplicitComp-1"></a><a class="docs-heading-anchor-permalink" href="#The-Brachistochrone-with-SparseADExplicitComp" title="Permalink"></a></h2><p>Finally, let&#39;s implement the Brachistochrone problem from <a href="../brachistochrone/#A-Simple-Dymos-Example">A Simple Dymos Example</a> using <code>SparseADExplicitComp</code>. This will demonstrate how to add units and tags to variables used in a <code>SparseADExplicitComp</code> component.</p><p>First, let&#39;s start a new Julia script, and import Dymos:</p><pre><code class="language-julia hljs">using ADTypes: ADTypes
using ComponentArrays: ComponentVector
using OpenMDAOCore: OpenMDAOCore
using OpenMDAO: om, make_component
using PythonCall: pyimport, pydict
using SparseMatrixColorings: SparseMatrixColorings

dm = pyimport(&quot;dymos&quot;)</code></pre><p>Next, let&#39;s define the Brachistochrone ODE that takes in <code>ComponentVector</code>s.</p><pre><code class="language-julia hljs">function brachistochrone_ode!(Y, X, params)
    theta = @view X[:theta]
    g = X.g
    v = X.v

    cos_theta = cos.(theta)
    sin_theta = sin.(theta)

    # @view(Y[:vdot]) .= g .* cos_theta
    # @view(Y[:xdot]) .= v .* sin_theta
    # @view(Y[:ydot]) .= -v .* cos_theta
    # @view(Y[:check]) .= v ./ sin_theta
    (; vdot, xdot, ydot, check) = Y
    vdot .= g .* cos_theta
    xdot .= v .* sin_theta
    ydot .= -v .* cos_theta
    check .= v ./ sin_theta

    return nothing
end</code></pre><p>Now, for the tricky part: we need to give Dymos a function that, when passed the <code>num_nodes</code> keyword argument, returns a component that implements the ODE. The component this yet-to-be-written function will return will be a <code>SparseADExplicitComp</code>, and that means we will need to also create the required <code>ComponentVector</code>s for the inputs and outputs. How will we do that? Like this:</p><pre><code class="language-julia hljs">function brachistochrone_ode_factory(; num_nodes, static_gravity)
    v = rand(Float64, num_nodes) .+ 1
    theta = rand(Float64, num_nodes) .+ 2
    if static_gravity
        g = 9.81
    else
        g = fill(9.81, num_nodes)
    end
    X_ca = ComponentVector(v=v, theta=theta, g=g)

    xdot = zeros(num_nodes)
    ydot = zeros(num_nodes)
    vdot = zeros(num_nodes)
    check = zeros(num_nodes)
    Y_ca = ComponentVector(xdot=xdot, ydot=ydot, vdot=vdot, check=check)

    units_dict = Dict(:v=&gt;&quot;m/s&quot;, :theta=&gt;&quot;rad&quot;, :g=&gt;&quot;m/s**2&quot;, :xdot=&gt;&quot;m/s&quot;, :ydot=&gt;&quot;m/s&quot;, :vdot=&gt;&quot;m/s**2&quot;, :check=&gt;&quot;m/s&quot;)
    tags_dict = Dict(
        :xdot=&gt;[&quot;dymos.state_rate_source:x&quot;, &quot;dymos.state_units:m&quot;],
        :ydot=&gt;[&quot;dymos.state_rate_source:y&quot;, &quot;dymos.state_units:m&quot;],
        :vdot=&gt;[&quot;dymos.state_rate_source:v&quot;, &quot;dymos.state_units:m/s&quot;],
    )
    if static_gravity
        tags_dict[:g] = [&quot;dymos.static_target&quot;]
    end

    # Use the same AD as the previous example: ForwardDiff.jl, with `PerturbedDenseSparsityDetector`.
    sparse_atol = 1e-10
    sparsity_detector = OpenMDAOCore.PerturbedDenseSparsityDetector(ADTypes.AutoForwardDiff(); atol=sparse_atol, method=:direct)
    coloring_algorithm = SparseMatrixColorings.GreedyColoringAlgorithm()
    ad_backend = ADTypes.AutoSparse(ADTypes.AutoForwardDiff(); sparsity_detector=sparsity_detector, coloring_algorithm=coloring_algorithm)

    return make_component(OpenMDAOCore.SparseADExplicitComp(ad_backend, brachistochrone_ode!, Y_ca, X_ca; units_dict=units_dict, tags_dict=tags_dict))
end</code></pre><p><code>brachistochrone_ode_factory</code> takes to keyword arguments: the <code>num_nodes</code> argument that Dymos requires, and the <code>static_gravity</code> argument from the <a href="https://openmdao.github.io/dymos/examples/brachistochrone/brachistochrone.html">original Dymos example</a>. Once we know the value of <code>num_nodes</code>, we can create the <code>X_ca</code> and <code>Y_ca</code> <code>ComponentVector</code>s as usual, with the <code>static_gravity</code> parameter influencing the size of <code>g</code>. We also create two dictionaries: <code>units_dict</code> and <code>tags_dict</code>. <code>units_dict</code> maps variable names (expressed as <code>Symbol</code>s, just like the component names for the <code>ComponentVector</code>s) to <code>String</code>s defining the units of the variable. The <code>tags_dict</code> similarly maps <code>Symbol</code> variable names to <code>Vector</code>s of <code>String</code> specifying the tags for each variable. Both <code>Dict</code>s are passed to the <code>SparseADExplicitComp</code> constructor as keyword arguments. Finally, the resulting <code>SparseADExplicitComp</code> is passed to <code>make_component</code> to actually create the Python OpenMDAO component.</p><p>Now, let&#39;s actually define the problem and run the optimization. We&#39;ll define a driver function called <code>doit</code> that allows us to try the example with the <code>static_gravity</code> argument set to <code>true</code> and <code>false</code>.</p><pre><code class="language-julia hljs">function doit(; static_gravity)
    # Initialize the Problem and the optimization driver
    #
    p = om.Problem(model=om.Group())
    p.driver = om.ScipyOptimizeDriver()
    p.driver.declare_coloring()
    #
    # Create a trajectory and add a phase to it
    #
    traj = p.model.add_subsystem(&quot;traj&quot;, dm.Trajectory())


    phase = traj.add_phase(&quot;phase0&quot;,
                           dm.Phase(ode_class=brachistochrone_ode_factory, ode_init_kwargs=pydict(Dict(&quot;static_gravity&quot;=&gt;static_gravity)),
                                    transcription = dm.GaussLobatto(num_segments=10)))

    #
    # Set the variables
    #
    phase.set_time_options(fix_initial=true, duration_bounds=(.5, 10))

    phase.add_state(&quot;x&quot;, fix_initial=true, fix_final=true)

    phase.add_state(&quot;y&quot;, fix_initial=true, fix_final=true)

    phase.add_state(&quot;v&quot;, fix_initial=true, fix_final=false)

    phase.add_control(&quot;theta&quot;, continuity=true, rate_continuity=true,
                      units=&quot;deg&quot;, lower=0.01, upper=179.9)

    phase.add_parameter(&quot;g&quot;, units=&quot;m/s**2&quot;, val=9.80665)

    #
    # Minimize time at the end of the phase
    #
    phase.add_objective(&quot;time&quot;, loc=&quot;final&quot;, scaler=10)
    #
    p.model.linear_solver = om.DirectSolver()
    #
    # Setup the Problem
    #
    p.setup()

    #
    # Set the initial values
    #
    p[&quot;traj.phase0.t_initial&quot;] = 0.0
    p[&quot;traj.phase0.t_duration&quot;] = 2.0

    p.set_val(&quot;traj.phase0.states:x&quot;, phase.interp(&quot;x&quot;, ys=[0, 10]))
    p.set_val(&quot;traj.phase0.states:y&quot;, phase.interp(&quot;y&quot;, ys=[10, 5]))
    p.set_val(&quot;traj.phase0.states:v&quot;, phase.interp(&quot;v&quot;, ys=[0, 9.9]))
    p.set_val(&quot;traj.phase0.controls:theta&quot;, phase.interp(&quot;theta&quot;, ys=[5, 100.5]))

    #
    # Solve for the optimal trajectory
    #
    dm.run_problem(p)

    # Check the results
    println(&quot;static_gravity = $static_gravity, elapsed time = $(p.get_val(&quot;traj.phase0.timeseries.time&quot;)[-1]) (should be 1.80164719)&quot;)
end</code></pre><p>The <code>doit</code> function is essentially identical to the previous version from <a href="../brachistochrone/#A-Simple-Dymos-Example">A Simple Dymos Example</a>. The only difference is in the <code>ode_class</code> argument in the call to <code>dm.Phase</code>: we assign that argument to our <code>brachistochrone_ode_factory</code> function. We also need to tell Dymos about the value of the <code>static_gravity</code> option we would like to use, which can be done via the <code>ode_init_kwargs</code> argument. In Python, this would normally be a <code>dict</code> with string keys. To do this in Julia, we first create a <code>Dict</code> with <code>String</code> keys, then use the <code>pydict</code> function from PythonCall to convert the Julia <code>Dict</code> to a Python <code>dict</code>.</p><p>With all that in place, we can run the optimization! Let&#39;s try with <code>static_gravity=true</code>:</p><pre><code class="language-julia hljs">doit(; static_gravity=true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Jacobian shape: (40, 50)  (13.40% nonzero)
FWD solves: 8   REV solves: 0
Total colors vs. total size: 8 vs 50  (84.00% improvement)

Sparsity computed using tolerance: 1e-25.
Dense total jacobian for Problem &#39;problem3&#39; was computed 3 times.
Time to compute sparsity:   1.6491 sec
Time to compute coloring:   0.0392 sec
Coloring created on: 2025-05-09 17:08:22
static_gravity = true, elapsed time = [1.80161673] (should be 1.80164719)</code></pre><p>Got the right answer!</p><p>And now, <code>static_gravity=false</code>:</p><pre><code class="language-julia hljs">doit(; static_gravity=false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Optimization terminated successfully    (Exit mode 0)
            Current function value: 18.016167304638337
            Iterations: 24
            Function evaluations: 24
            Gradient evaluations: 24
Optimization Complete
-----------------------------------

Jacobian shape: (40, 50)  (13.40% nonzero)
FWD solves: 8   REV solves: 0
Total colors vs. total size: 8 vs 50  (84.00% improvement)

Sparsity computed using tolerance: 1e-25.
Dense total jacobian for Problem &#39;problem4&#39; was computed 3 times.
Time to compute sparsity:   1.2230 sec
Time to compute coloring:   0.0389 sec
Coloring created on: 2025-05-09 17:08:31
static_gravity = false, elapsed time = [1.80161673] (should be 1.80164719)</code></pre><p>Also looks good!</p><h2 id="The-Brachistochrone-with-SparseADExplicitComp-and-User-Defined-Sparsity"><a class="docs-heading-anchor" href="#The-Brachistochrone-with-SparseADExplicitComp-and-User-Defined-Sparsity">The Brachistochrone with <code>SparseADExplicitComp</code> and User-Defined Sparsity</a><a id="The-Brachistochrone-with-SparseADExplicitComp-and-User-Defined-Sparsity-1"></a><a class="docs-heading-anchor-permalink" href="#The-Brachistochrone-with-SparseADExplicitComp-and-User-Defined-Sparsity" title="Permalink"></a></h2><p>Having OpenMDAOCore.jl determine the sparsity pattern of your component is quite convent, but involves evaluating the full Jacobian multiple times, which may be expensive depending on the complexity of your component. Often it&#39;s quite easy to figure out the sparsity pattern yourself, and DifferentiationInterface.jl supports a user-defined sparsity pattern. So let&#39;s learn how to do that with the previous Brachistochrone example.</p><p>We&#39;ll start fresh again:</p><pre><code class="language-julia hljs">using ADTypes: ADTypes
using ComponentArrays: ComponentVector, ComponentMatrix, getdata, getaxes
using OpenMDAOCore: OpenMDAOCore
using OpenMDAO: om, make_component
using PythonCall: pyimport, pydict
using SparseArrays: sparse
using SparseMatrixColorings: SparseMatrixColorings

dm = pyimport(&quot;dymos&quot;)</code></pre><p>We&#39;ll implement the same ODE, but this time let&#39;s try doing an out-of-place callback function, just for fun:</p><pre><code class="language-julia hljs">function brachistochrone_ode(X, params)
    theta = @view X[:theta]
    g = X.g
    v = X.v

    cos_theta = cos.(theta)
    sin_theta = sin.(theta)

    vdot = g .* cos_theta
    xdot = v .* sin_theta
    ydot = -v .* cos_theta
    check = v ./ sin_theta

    return ComponentVector(vdot=vdot, xdot=xdot, ydot=ydot, check=check)
end</code></pre><p>We also need a &quot;factory function&quot; like last time that will take <code>num_nodes</code> as a keyword argument, and define units and takes, and finally returns an OpenMDAO Python component. Now, to use user-defined sparsity, we need to be able to create a sparse matrix representing the Jacobian of our component, with zeros for all the zero entries, of course. The easiest way to do that is to create a <code>ComponentMatrix</code> inside the factory function, like so:</p><pre><code class="language-julia hljs">function brachistochrone_ode_factory(; num_nodes, static_gravity)
    v = rand(Float64, num_nodes) .+ 1
    theta = rand(Float64, num_nodes) .+ 2
    if static_gravity
        g = 9.81
    else
        g = fill(9.81, num_nodes)
    end
    X_ca = ComponentVector(v=v, theta=theta, g=g)

    # Get the output ComponentVector by calling the ODE function.
    Y_ca = brachistochrone_ode(X_ca, nothing)

    # Create a Matrix representing the Jacobian, with the number of rows equal to the number of outputs, and the number of columns equal to the number of inputs:
    J = zeros(length(Y_ca), length(X_ca))
    # Now create a ComponentMatrix from J, with the appropriate names for the inputs and outputs:
    J_ca = ComponentMatrix(J, only(getaxes(Y_ca)), only(getaxes(X_ca)))
    # Fill the ComponentMatrix with zeros first...
    J_ca .= 0.0

    # Now mark all the non-zero entries with 1.0.
    for n in 1:num_nodes
        # vdot are functions of theta and g.
        @view(J_ca[:vdot, :theta])[n, n] = 1.0
        if static_gravity
            @view(J_ca[:vdot, :g])[n, 1] = 1.0
        else
            @view(J_ca[:vdot, :g])[n, n] = 1.0
        end

        # xdot, ydot, and check depend on v and theta.
        @view(J_ca[:xdot, :theta])[n, n] = 1.0
        @view(J_ca[:xdot, :v])[n, n] = 1.0
        @view(J_ca[:ydot, :theta])[n, n] = 1.0
        @view(J_ca[:ydot, :v])[n, n] = 1.0
        @view(J_ca[:check, :theta])[n, n] = 1.0
        @view(J_ca[:check, :v])[n, n] = 1.0
    end

    units_dict = Dict(:v=&gt;&quot;m/s&quot;, :theta=&gt;&quot;rad&quot;, :g=&gt;&quot;m/s**2&quot;, :xdot=&gt;&quot;m/s&quot;, :ydot=&gt;&quot;m/s&quot;, :vdot=&gt;&quot;m/s**2&quot;, :check=&gt;&quot;m/s&quot;)
    tags_dict = Dict(
        :xdot=&gt;[&quot;dymos.state_rate_source:x&quot;, &quot;dymos.state_units:m&quot;],
        :ydot=&gt;[&quot;dymos.state_rate_source:y&quot;, &quot;dymos.state_units:m&quot;],
        :vdot=&gt;[&quot;dymos.state_rate_source:v&quot;, &quot;dymos.state_units:m/s&quot;],
    )
    if static_gravity
        tags_dict[:g] = [&quot;dymos.static_target&quot;]
    end

    # Use the same AD as the previous example: ForwardDiff.jl, with `PerturbedDenseSparsityDetector`.
    sparsity_detector = ADTypes.KnownJacobianSparsityDetector(sparse(getdata(J_ca)))
    coloring_algorithm = SparseMatrixColorings.GreedyColoringAlgorithm()
    ad_backend = ADTypes.AutoSparse(ADTypes.AutoForwardDiff(); sparsity_detector=sparsity_detector, coloring_algorithm=coloring_algorithm)

    return make_component(OpenMDAOCore.SparseADExplicitComp(ad_backend, brachistochrone_ode, X_ca; units_dict=units_dict, tags_dict=tags_dict))
end</code></pre><p>Let&#39;s break down the portion of the code that creates and sets <code>J_ca</code>. We start by creating some examples of <code>X_ca</code> and <code>Y_ca</code> to play around with:</p><pre><code class="language-julia hljs">nn = 4
X_ca_test = ComponentVector(v=range(1.0, 2.0; length=nn), theta=range(2.0, 3.0, length=nn), g=9.81)
Y_ca_test = brachistochrone_ode(X_ca_test, nothing)
@show X_ca_test Y_ca_test</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">X_ca_test = (v = [1.0, 1.3333333333333333, 1.6666666666666667, 2.0], theta = [2.0, 2.3333333333333335, 2.6666666666666665, 3.0], g = 9.81)
Y_ca_test = (vdot = [-4.082400466527467, -6.776337350946288, -8.724293634169936, -9.71182639165037], xdot = [0.9092974268256817, 0.9641145089844327, 0.76212104439302, 0.2822400161197344], ydot = [0.4161468365471424, 0.9210108529998352, 1.4822109470217357, 1.9799849932008908], check = [1.0997501702946164, 1.8439487853475327, 3.644798681540277, 14.172334791474373])</code></pre><p>Now we create a <code>Matrix</code> representing the Jacobian, with the number of rows equal to the number of outputs, and the number of columns equal to the number of inputs:</p><pre><code class="language-julia hljs">J_test = zeros(length(Y_ca_test), length(X_ca_test))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">16×9 Matrix{Float64}:
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0</code></pre><p>The size of <code>J_test</code> is <code>(16, 9)</code> which is what we expect: there are <code>4 + 4 + 1 = 9</code> inputs and <code>4 + 4 + 4 + 4=16</code> outputs. But we want to create a <code>ComponentMatrix</code> so we can easily pull out the sub-Jacobians. The easiest way to do that is to get the &quot;axes&quot; for the input and output <code>ComponentVector</code>s, and then use those when constructing the <code>ComponentMatrix</code> like so. To get the axes, we use the <code>getaxes</code> function from ComponentArrays.jl. For the input <code>ComponentVector</code>:</p><pre><code class="language-julia hljs">X_axes = getaxes(X_ca_test)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(Axis(v = ViewAxis(1:4, Shaped1DAxis((4,))), theta = ViewAxis(5:8, Shaped1DAxis((4,))), g = 9),)</code></pre><p>and for the output <code>ComponentVector</code>:</p><pre><code class="language-julia hljs">Y_axes = getaxes(Y_ca_test)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(Axis(vdot = ViewAxis(1:4, Shaped1DAxis((4,))), xdot = ViewAxis(5:8, Shaped1DAxis((4,))), ydot = ViewAxis(9:12, Shaped1DAxis((4,))), check = ViewAxis(13:16, Shaped1DAxis((4,)))),)</code></pre><p>Now we create a <code>ComponentMatrix</code> like so:</p><pre><code class="language-julia hljs">J_ca_test = ComponentMatrix(J_test, only(Y_axes), only(X_axes))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">16×9 ComponentMatrix{Float64} with axes Axis(vdot = ViewAxis(1:4, Shaped1DAxis((4,))), xdot = ViewAxis(5:8, Shaped1DAxis((4,))), ydot = ViewAxis(9:12, Shaped1DAxis((4,))), check = ViewAxis(13:16, Shaped1DAxis((4,)))) × Axis(v = ViewAxis(1:4, Shaped1DAxis((4,))), theta = ViewAxis(5:8, Shaped1DAxis((4,))), g = 9)
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0</code></pre><p>(<code>only</code> is a small Julia function that returns the single value of a length-1 collection [<code>Array</code>, <code>Tuple</code>, etc.] or throws an error if called on something with more than one value.) Now that we have a <code>ComponentMatrix</code>, it&#39;s relatively easy to set the non-zero entries to something other than zero. For example, the, say, second entry of <code>vdot</code> depends on the second entry of <code>theta</code>, and we can communicate that by doing this:</p><pre><code class="language-julia hljs">@view(J_ca_test[:vdot, :theta])[2, 2] = 1.0
J_ca_test</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">16×9 ComponentMatrix{Float64} with axes Axis(vdot = ViewAxis(1:4, Shaped1DAxis((4,))), xdot = ViewAxis(5:8, Shaped1DAxis((4,))), ydot = ViewAxis(9:12, Shaped1DAxis((4,))), check = ViewAxis(13:16, Shaped1DAxis((4,)))) × Axis(v = ViewAxis(1:4, Shaped1DAxis((4,))), theta = ViewAxis(5:8, Shaped1DAxis((4,))), g = 9)
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0</code></pre><p><a href="https://docs.sciml.ai/ComponentArrays/stable/indexing_behavior/#Views-and-slices">As explained in the ComponentArrays.jl docs</a>, the <code>@view</code> macro is necessary to modify elements of <code>J_ca_test</code>—otherwise we would be modifying a copy of a portion of <code>J_ca_test</code>, since slicing operations in Julia create copies.</p><p>Now, we&#39;re ready to start creating an OpenMDAO <code>Problem</code>, like last time:</p><pre><code class="language-julia hljs"># Initialize the Problem and the optimization driver
#
p = om.Problem(model=om.Group())
p.driver = om.ScipyOptimizeDriver()
p.driver.declare_coloring()
#
# Create a trajectory and add a phase to it
#
traj = p.model.add_subsystem(&quot;traj&quot;, dm.Trajectory())

static_gravity = false
phase = traj.add_phase(&quot;phase0&quot;,
                       dm.Phase(ode_class=brachistochrone_ode_factory, ode_init_kwargs=pydict(Dict(&quot;static_gravity&quot;=&gt;static_gravity)),
                                transcription = dm.GaussLobatto(num_segments=10)))

#
# Set the variables
#
phase.set_time_options(fix_initial=true, duration_bounds=(.5, 10))

phase.add_state(&quot;x&quot;, fix_initial=true, fix_final=true)

phase.add_state(&quot;y&quot;, fix_initial=true, fix_final=true)

phase.add_state(&quot;v&quot;, fix_initial=true, fix_final=false)

phase.add_control(&quot;theta&quot;, continuity=true, rate_continuity=true,
                  units=&quot;deg&quot;, lower=0.01, upper=179.9)

phase.add_parameter(&quot;g&quot;, units=&quot;m/s**2&quot;, val=9.80665)

#
# Minimize time at the end of the phase
#
phase.add_objective(&quot;time&quot;, loc=&quot;final&quot;, scaler=10)
#
p.model.linear_solver = om.DirectSolver()
#
# Setup the Problem
#
p.setup(force_alloc_complex=true)

#
# Set the initial values
#
p[&quot;traj.phase0.t_initial&quot;] = 0.0
p[&quot;traj.phase0.t_duration&quot;] = 2.0

p.set_val(&quot;traj.phase0.states:x&quot;, phase.interp(&quot;x&quot;, ys=[0, 10]))
p.set_val(&quot;traj.phase0.states:y&quot;, phase.interp(&quot;y&quot;, ys=[10, 5]))
p.set_val(&quot;traj.phase0.states:v&quot;, phase.interp(&quot;v&quot;, ys=[0, 9.9]))
p.set_val(&quot;traj.phase0.controls:theta&quot;, phase.interp(&quot;theta&quot;, ys=[5, 100.5]))</code></pre><p>But it would be a good idea to check our derivatives first, since that should reveal any bugs in our sparsity pattern.</p><pre><code class="language-julia hljs"># Not sure why I have to do this song and dance.
using PythonCall: PyIO
foo = pyimport(&quot;io&quot;).StringIO()
bar = PyIO(foo)
p.check_partials(out_stream=bar, method=&quot;cs&quot;)
flush(bar)
foo.seek(0)
println(foo.read())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">/home/runner/work/OpenMDAO.jl/OpenMDAO.jl/docs/.CondaPkg/env/lib/python3.12/site-packages/openmdao/core/component.py:2571: DerivativesWarning:
Component &#39;traj.phases.phase0.rhs_disc&#39; has zero derivatives for the following variable pairs that were declared as &#39;dependent&#39;: [(&#39;check&#39;, &#39;g&#39;), (&#39;vdot&#39;, &#39;v&#39;), (&#39;xdot&#39;, &#39;g&#39;), (&#39;ydot&#39;, &#39;g&#39;)].

/home/runner/work/OpenMDAO.jl/OpenMDAO.jl/docs/.CondaPkg/env/lib/python3.12/site-packages/openmdao/core/component.py:2571: DerivativesWarning:
Component &#39;traj.phases.phase0.rhs_col&#39; has zero derivatives for the following variable pairs that were declared as &#39;dependent&#39;: [(&#39;check&#39;, &#39;g&#39;), (&#39;vdot&#39;, &#39;v&#39;), (&#39;xdot&#39;, &#39;g&#39;), (&#39;ydot&#39;, &#39;g&#39;)].

----------------------------------------------------------
Component: JuliaExplicitComp &#39;traj.phases.phase0.rhs_disc&#39;
----------------------------------------------------------

  traj.phases.phase0.rhs_disc: &#39;check&#39; wrt &#39;g&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

    Raw CS Derivative (Jfd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_disc: &#39;check&#39; wrt &#39;theta&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.         -15.18286243   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.         -15.18286243   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.         -10.84010592   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.         -10.84010592   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.          -8.05199538   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.          -8.05199538   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.          -6.16023594   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.          -6.16023594   0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.          -4.72871608   0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -4.72871608   0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -3.52224099   0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -3.52224099   0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -2.39072079   0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -2.39072079   0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -1.21140799   0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -1.21140799   0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.14776725
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.14776725   0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           1.86610464]]

    Raw CS Derivative (Jfd)
    [[  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.         -15.18286243   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.         -15.18286243   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.         -10.84010592   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.         -10.84010592   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.          -8.05199538   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.          -8.05199538   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.          -6.16023594   0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.          -6.16023594   0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.          -4.72871608   0.           0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -4.72871608   0.           0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -3.52224099   0.           0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -3.52224099   0.           0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -2.39072079   0.           0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -2.39072079   0.           0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -1.21140799   0.           0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.          -1.21140799   0.
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.14776725
        0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.14776725   0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.           0.
        0.           1.86610464]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_disc: &#39;check&#39; wrt &#39;v&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[11.47371325  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          3.98049911  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          3.98049911  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          2.44899682  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          2.44899682  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          1.80466911  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          1.80466911  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          1.46081985  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          1.46081985  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          1.25627825  0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.25627825  0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.12944116  0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.12944116  0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.05236101  0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.05236101  0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.01137148  0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.01137148  0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.00013747  0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.00013747
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       1.01703027]]

    Raw CS Derivative (Jfd)
    [[11.47371325  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          3.98049911  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          3.98049911  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          2.44899682  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          2.44899682  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          1.80466911  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          1.80466911  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          1.46081985  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          1.46081985  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          1.25627825  0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.25627825  0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.12944116  0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.12944116  0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.05236101  0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.05236101  0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.01137148  0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.01137148  0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.00013747  0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.00013747
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       1.01703027]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_disc: &#39;vdot&#39; wrt &#39;g&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[ 0.9961947   0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.96792877  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.96792877  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.91283418  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.91283418  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.832438    0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.832438    0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.72896863  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.72896863  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.60529399  0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.60529399  0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.46484205  0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.46484205  0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.31150579  0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.31150579  0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.14953534  0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.14953534  0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.01657987  0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.01657987
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
      -0.18223553]]

    Raw CS Derivative (Jfd)
    [[ 0.9961947   0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.96792877  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.96792877  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.91283418  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.91283418  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.832438    0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.832438    0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.72896863  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.72896863  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.60529399  0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.60529399  0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.46484205  0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.46484205  0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.31150579  0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.31150579  0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.14953534  0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.14953534  0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.01657987  0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.01657987
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
      -0.18223553]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_disc: &#39;vdot&#39; wrt &#39;theta&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[-0.85470586  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.         -2.46367346  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.         -2.46367346  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.         -4.00435391  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.         -4.00435391  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.         -5.43404324  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.         -5.43404324  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -6.71311388  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.         -6.71311388  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -7.80611304  0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -7.80611304  0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -8.6827454   0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -8.6827454   0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.31871281  0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.31871281  0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.69638776  0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.69638776  0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.80530202  0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.80530202
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
      -9.64243674]]

    Raw CS Derivative (Jfd)
    [[-0.85470586  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.         -2.46367346  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.         -2.46367346  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.         -4.00435391  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.         -4.00435391  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.         -5.43404324  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.         -5.43404324  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -6.71311388  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.         -6.71311388  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -7.80611304  0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -7.80611304  0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -8.6827454   0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -8.6827454   0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.31871281  0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.31871281  0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.69638776  0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.69638776  0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.80530202  0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.80530202
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
      -9.64243674]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_disc: &#39;vdot&#39; wrt &#39;v&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

    Raw CS Derivative (Jfd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_disc: &#39;xdot&#39; wrt &#39;g&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

    Raw CS Derivative (Jfd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_disc: &#39;xdot&#39; wrt &#39;theta&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.95824949  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.95824949  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          1.80741167  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          1.80741167  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          2.47234086  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          2.47234086  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          2.88671576  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          2.88671576  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          2.99620524  0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          2.99620524  0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          2.76116175  0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          2.76116175  0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          2.15873514  0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          2.15873514  0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.18431992  0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.18431992  0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.14772663  0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.14772663
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
      -1.8041317 ]]

    Raw CS Derivative (Jfd)
    [[ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.95824949  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.95824949  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          1.80741167  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          1.80741167  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          2.47234086  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          2.47234086  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          2.88671576  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          2.88671576  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          2.99620524  0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          2.99620524  0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          2.76116175  0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          2.76116175  0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          2.15873514  0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          2.15873514  0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.18431992  0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          1.18431992  0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.14772663  0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.14772663
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
      -1.8041317 ]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_disc: &#39;xdot&#39; wrt &#39;v&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[0.08715574 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.25122478 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.25122478 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.40833046 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.40833046 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.5541182  0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.5541182  0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.68454711 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.68454711 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.796002   0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.796002   0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.88539363 0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.88539363 0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.95024425 0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.95024425 0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.98875638 0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.98875638 0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.99986254 0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.99986254 0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.98325491]]

    Raw CS Derivative (Jfd)
    [[0.08715574 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.25122478 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.25122478 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.40833046 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.40833046 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.5541182  0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.5541182  0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.68454711 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.68454711 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.796002   0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.796002   0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.88539363 0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.88539363 0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.95024425 0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.95024425 0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.98875638 0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.98875638 0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.99986254 0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.99986254 0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.98325491]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_disc: &#39;ydot&#39; wrt &#39;g&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

    Raw CS Derivative (Jfd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_disc: &#39;ydot&#39; wrt &#39;theta&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.24871253 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.24871253 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.80849431 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.80849431 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         1.64573105 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         1.64573105 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         2.71080654 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         2.71080654 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         3.94020991 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         3.94020991 0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         5.25923814 0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         5.25923814 0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         6.58519268 0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         6.58519268 0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         7.83095054 0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         7.83095054 0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         8.90877527 0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         8.90877527 0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         9.73422358]]

    Raw CS Derivative (Jfd)
    [[0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.24871253 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.24871253 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.80849431 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.80849431 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         1.64573105 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         1.64573105 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         2.71080654 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         2.71080654 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         3.94020991 0.         0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         3.94020991 0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         5.25923814 0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         5.25923814 0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         6.58519268 0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         6.58519268 0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         7.83095054 0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         7.83095054 0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         8.90877527 0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         8.90877527 0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         0.         9.73422358]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_disc: &#39;ydot&#39; wrt &#39;v&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[-0.9961947   0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.         -0.96792877  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.         -0.96792877  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.         -0.91283418  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.         -0.91283418  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.         -0.832438    0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.         -0.832438    0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -0.72896863  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.         -0.72896863  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.60529399  0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.60529399  0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.46484205  0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.46484205  0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.31150579  0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.31150579  0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.14953534  0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.14953534  0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.01657987  0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.01657987
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.18223553]]

    Raw CS Derivative (Jfd)
    [[-0.9961947   0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.         -0.96792877  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.         -0.96792877  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.         -0.91283418  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.         -0.91283418  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.         -0.832438    0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.         -0.832438    0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -0.72896863  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.         -0.72896863  0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.60529399  0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.60529399  0.          0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.46484205  0.          0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.46484205  0.          0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.31150579  0.          0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.31150579  0.          0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.14953534  0.          0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.14953534  0.          0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.01657987  0.
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.01657987
       0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.          0.
       0.18223553]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

---------------------------------------------------------
Component: JuliaExplicitComp &#39;traj.phases.phase0.rhs_col&#39;
---------------------------------------------------------

  traj.phases.phase0.rhs_col: &#39;check&#39; wrt &#39;g&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

    Raw CS Derivative (Jfd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_col: &#39;check&#39; wrt &#39;theta&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[-17.16015325   0.           0.           0.           0.           0.           0.           0.           0.           0.        ]
     [  0.         -12.91250925   0.           0.           0.           0.           0.           0.           0.           0.        ]
     [  0.           0.          -9.36802888   0.           0.           0.           0.           0.           0.           0.        ]
     [  0.           0.           0.          -7.07944558   0.           0.           0.           0.           0.           0.        ]
     [  0.           0.           0.           0.          -5.4413825    0.           0.           0.           0.           0.        ]
     [  0.           0.           0.           0.           0.          -4.133852     0.           0.           0.           0.        ]
     [  0.           0.           0.           0.           0.           0.          -2.9722181    0.           0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.          -1.8243861    0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.          -0.5665967    0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.95170718]]

    Raw CS Derivative (Jfd)
    [[-17.16015325   0.           0.           0.           0.           0.           0.           0.           0.           0.        ]
     [  0.         -12.91250925   0.           0.           0.           0.           0.           0.           0.           0.        ]
     [  0.           0.          -9.36802888   0.           0.           0.           0.           0.           0.           0.        ]
     [  0.           0.           0.          -7.07944558   0.           0.           0.           0.           0.           0.        ]
     [  0.           0.           0.           0.          -5.4413825    0.           0.           0.           0.           0.        ]
     [  0.           0.           0.           0.           0.          -4.133852     0.           0.           0.           0.        ]
     [  0.           0.           0.           0.           0.           0.          -2.9722181    0.           0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.          -1.8243861    0.           0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.          -0.5665967    0.        ]
     [  0.           0.           0.           0.           0.           0.           0.           0.           0.           0.95170718]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_col: &#39;check&#39; wrt &#39;v&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[5.889992   0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         3.02182204 0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         2.07082064 0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         1.6090372  0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         1.34616173 0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         1.18535966 0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         1.08575802 0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         1.02787927 0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         1.00223252 0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         1.00501286]]

    Raw CS Derivative (Jfd)
    [[5.889992   0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         3.02182204 0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         2.07082064 0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         1.6090372  0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         1.34616173 0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         1.18535966 0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         1.08575802 0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         1.02787927 0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         1.00223252 0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         1.00501286]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_col: &#39;vdot&#39; wrt &#39;g&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[ 0.98548207  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.94365665  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.87567532  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.78342236  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.6694548   0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.53693156  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.38952586  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.23132343  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.06670927  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.09975392]]

    Raw CS Derivative (Jfd)
    [[ 0.98548207  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.94365665  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.87567532  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.78342236  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.6694548   0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.53693156  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.38952586  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.23132343  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.06670927  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.09975392]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_col: &#39;vdot&#39; wrt &#39;theta&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[-1.66496831  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.         -3.24527715  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.         -4.73563466  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.         -6.09473169  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.         -7.28489733  0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.         -8.27314302  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.         -9.03207695  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -9.5406633   0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.         -9.78480525  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.75773579]]

    Raw CS Derivative (Jfd)
    [[-1.66496831  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.         -3.24527715  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.         -4.73563466  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.         -6.09473169  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.         -7.28489733  0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.         -8.27314302  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.         -9.03207695  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -9.5406633   0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.         -9.78480525  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -9.75773579]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_col: &#39;vdot&#39; wrt &#39;v&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

    Raw CS Derivative (Jfd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_col: &#39;xdot&#39; wrt &#39;g&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

    Raw CS Derivative (Jfd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_col: &#39;xdot&#39; wrt &#39;theta&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[ 0.49464287  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          1.41407641  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          2.18455634  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          2.73443169  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          3.00271957  0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          2.94208108  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          2.52124228  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          1.72676223  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.56407527  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.9422369 ]]

    Raw CS Derivative (Jfd)
    [[ 0.49464287  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          1.41407641  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          2.18455634  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          2.73443169  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          3.00271957  0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          2.94208108  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          2.52124228  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          1.72676223  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.56407527  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.         -0.9422369 ]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_col: &#39;xdot&#39; wrt &#39;v&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[0.16977952 0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.33092617 0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.48290034 0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.62148967 0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.74285279 0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.84362581 0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.92101553 0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.9728769  0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.99777246 0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.99501214]]

    Raw CS Derivative (Jfd)
    [[0.16977952 0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.33092617 0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.48290034 0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.62148967 0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.74285279 0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.84362581 0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.92101553 0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.9728769  0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.99777246 0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         0.99501214]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_col: &#39;ydot&#39; wrt &#39;g&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

    Raw CS Derivative (Jfd)
    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
     [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_col: &#39;ydot&#39; wrt &#39;theta&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[0.08521741 0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.4958953  0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         1.20469652 0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         2.16922716 0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         3.33193311 0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         4.62259199 0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         5.96135856 0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         7.26224366 0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         8.43689034 0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         9.39849977]]

    Raw CS Derivative (Jfd)
    [[0.08521741 0.         0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.4958953  0.         0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         1.20469652 0.         0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         2.16922716 0.         0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         3.33193311 0.         0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         4.62259199 0.         0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         5.96135856 0.         0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         7.26224366 0.         0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         8.43689034 0.        ]
     [0.         0.         0.         0.         0.         0.         0.         0.         0.         9.39849977]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  traj.phases.phase0.rhs_col: &#39;ydot&#39; wrt &#39;v&#39;

    Max Tolerance Violation (Jfwd - Jfd) - (atol + rtol * Jfd) : 0.000000e+00 *
      abs error: 0.000000e+00
      rel error: inf
      fwd value: 0.000000e+00
      fd value: 0.000000e+00 (cs:None)

    Raw Forward Derivative (Jfwd)
    [[-0.98548207  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.         -0.94365665  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.         -0.87567532  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.         -0.78342236  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.         -0.6694548   0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.         -0.53693156  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.         -0.38952586  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -0.23132343  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.         -0.06670927  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.09975392]]

    Raw CS Derivative (Jfd)
    [[-0.98548207  0.          0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.         -0.94365665  0.          0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.         -0.87567532  0.          0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.         -0.78342236  0.          0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.         -0.6694548   0.          0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.         -0.53693156  0.          0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.         -0.38952586  0.          0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.         -0.23132343  0.          0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.         -0.06670927  0.        ]
     [ 0.          0.          0.          0.          0.          0.          0.          0.          0.          0.09975392]]

 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</code></pre><p>Derivatives look good. So now let&#39;s run the optimization:</p><pre><code class="language-julia hljs">#
# Solve for the optimal trajectory
#
dm.run_problem(p)

# Check the results
println(&quot;elapsed time = $(p.get_val(&quot;traj.phase0.timeseries.time&quot;)[-1]) (should be 1.80164719)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Optimization terminated successfully    (Exit mode 0)
            Current function value: 18.016167304638337
            Iterations: 24
            Function evaluations: 24
            Gradient evaluations: 24
Optimization Complete
-----------------------------------

Jacobian shape: (40, 50)  (13.40% nonzero)
FWD solves: 8   REV solves: 0
Total colors vs. total size: 8 vs 50  (84.00% improvement)

Sparsity computed using tolerance: 1e-25.
Dense total jacobian for Problem &#39;problem5&#39; was computed 3 times.
Time to compute sparsity:   0.0244 sec
Time to compute coloring:   0.0393 sec
Coloring created on: 2025-05-09 17:08:41
elapsed time = [1.80161673] (should be 1.80164719)</code></pre><p>Again, looks good!</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../brachistochrone/">« A Simple Dymos Example</a><a class="docs-footer-nextpage" href="../matrix_free_ad/">Auto-Matrix-Free Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 9 May 2025 17:09">Friday 9 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
